# Title : get Best Seller Book [8]
# Description : join query and get 8 Books that sold out so much.
# Date :  2018 / 05 / 30 
# Author : Park yun seok
# [B.BOOK_UID, ISBN, TITLE, PRICE, WRITER_CODE, PUBLISHER, BOOK_QUANTITY, GENRE_CODE, ORIGIN, IMAGE, PAGE, SQ]

categoryQ=SELECT * FROM BANDI_BOOK B, (SELECT BOOK_UID, SUM(QUANTITY) SQ FROM ORDER_TABLE GROUP BY BOOK_UID ORDER BY SQ DESC) D WHERE B.BOOK_UID = D.BOOK_UID AND GENRE_CODE LIKE ? AND ROWNUM <=8
rankQ=SELECT BK.BOOK_UID, TITLE, PRICE, WRITER_NAME, ISBN, TRUNC(RATE,1) RAT, IMAGE FROM BANDI_BOOK BK, WRITER W, (SELECT B.BOOK_UID, AVG(RATING) RATE, COUNT(*) AL FROM BANDI_BOOK B, BANDI_COMMENT C WHERE B.BOOK_UID = C.BOOK_UID AND B.GENRE_CODE LIKE ? GROUP BY B.BOOK_UID HAVING COUNT(*)>=3) SS WHERE SS.BOOK_UID = BK.BOOK_UID AND BK.WRITER_CODE = W.WRITER_CODE AND ROWNUM <=1 ORDER BY RAT DESC
commentQ=SELECT E_MAIL, RATING, BOOK_COMMENT, WRITED_DATE FROM(SELECT * FROM BANDI_COMMENT JOIN BANDI_BOOK USING (BOOK_UID) JOIN WRITER USING (WRITER_CODE)JOIN BANDI_USER USING(USER_UID) WHERE BOOK_UID = ? ORDER BY SYSDATE DESC, RATING DESC) WHERE ROWNUM <= 3
bestSellQ=SELECT BOOK_UID, ISBN, TITLE, PRICE, IMAGE FROM BANDI_BOOK JOIN ORDER_DETAIL O USING(BOOK_UID) WHERE GENRE_CODE LIKE ? AND ROWNUM <=8 ORDER BY O.QUANTITY DESC